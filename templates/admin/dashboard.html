{% extends "admin/base_site.html" %}
{% load static %}

{% block extrastyle %}
{{ block.super }}
<style>
    :root {
        --military-blue: #003366;
        --military-red: #8b0000;
        --military-green: #1e4620;
        --military-gold: #ffd700;
    }

    .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin: 1.5rem 0;
    }

    .stats-card {
        background: white;
        padding: 1.5rem;
        border-radius: 6px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        border-top: 4px solid var(--military-blue);
    }

    .staff-section {
        background: white;
        padding: 1.5rem;
        border-radius: 6px;
        margin-bottom: 1.5rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .staff-section h2 {
        color: var(--military-blue);
        border-bottom: 2px solid #eee;
        padding-bottom: 0.5rem;
        margin-bottom: 1rem;
    }

    .staff-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 1rem;
    }

    .staff-card {
        background: #f8f9fa;
        padding: 1rem;
        border-radius: 4px;
        border-left: 4px solid var(--military-blue);
    }

    .class-section {
        margin-top: 2rem;
    }

    .class-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1rem;
    }

    .class-card {
        background: white;
        padding: 1rem;
        border-radius: 4px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        border-left: 4px solid var(--military-green);
    }

    .role-badge {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 3px;
        font-size: 0.875rem;
        font-weight: 500;
        color: white;
        background: var(--military-blue);
    }

    .status-badge {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 3px;
        font-size: 0.875rem;
        color: white;
    }

    .status-active {
        background: var(--military-green);
    }

    .status-suspended {
        background: var(--military-red);
    }

    .hierarchy-title {
        text-align: center;
        margin-bottom: 2rem;
        padding: 1rem;
        background: var(--military-blue);
        color: white;
        border-radius: 6px;
    }

    .hierarchy-title h1 {
        margin: 0;
        font-size: 1.5rem;
    }

    .hierarchy-subtitle {
        color: var(--military-gold);
        font-size: 0.9rem;
        margin-top: 0.5rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="hierarchy-title">
    <h1>School of Information Technology for Defence Systems (SITDS)</h1>
    <div class="hierarchy-subtitle">
        Defence Forces Technical College (DEFTEC) â€¢ National Defence University-Kenya (NDU-K)
    </div>
</div>

<div class="dashboard-grid">
    <div class="stats-card">
        <h3>Senior Instructors</h3>
        <p class="count">{{ role_counts.senior_instructors }}</p>
    </div>
    <div class="stats-card">
        <h3>Adjutants</h3>
        <p class="count">{{ role_counts.adjutants }}</p>
    </div>
    <div class="stats-card">
        <h3>School Sergeants Major</h3>
        <p class="count">{{ role_counts.sergeants_major }}</p>
    </div>
    <div class="stats-card">
        <h3>Class Commanders</h3>
        <p class="count">{{ role_counts.class_commanders }}</p>
    </div>
</div>

<!-- Senior Instructors Section -->
<div class="staff-section">
    <h2>Senior Instructors</h2>
    <div class="staff-grid">
        {% for instructor in senior_instructors %}
        <div class="staff-card">
            <h4>{{ instructor.get_full_name }}</h4>
            <p>{{ instructor.email }}</p>
            <span class="status-badge {% if instructor.is_active %}status-active{% else %}status-suspended{% endif %}">
                {% if instructor.is_active %}Active{% else %}Inactive{% endif %}
            </span>
        </div>
        {% empty %}
        <p>No Senior Instructors assigned</p>
        {% endfor %}
    </div>
</div>

<!-- Adjutants Section -->
<div class="staff-section">
    <h2>Adjutants</h2>
    <div class="staff-grid">
        {% for adjutant in adjutants %}
        <div class="staff-card">
            <h4>{{ adjutant.get_full_name }}</h4>
            <p>{{ adjutant.email }}</p>
            <span class="status-badge {% if adjutant.is_active %}status-active{% else %}status-suspended{% endif %}">
                {% if adjutant.is_active %}Active{% else %}Inactive{% endif %}
            </span>
        </div>
        {% empty %}
        <p>No Adjutants assigned</p>
        {% endfor %}
    </div>
</div>

<!-- School Sergeants Major Section -->
<div class="staff-section">
    <h2>School Sergeants Major</h2>
    <div class="staff-grid">
        {% for sergeant in sergeants_major %}
        <div class="staff-card">
            <h4>{{ sergeant.get_full_name }}</h4>
            <p>{{ sergeant.email }}</p>
            <span class="status-badge {% if sergeant.is_active %}status-active{% else %}status-suspended{% endif %}">
                {% if sergeant.is_active %}Active{% else %}Inactive{% endif %}
            </span>
        </div>
        {% empty %}
        <p>No School Sergeants Major assigned</p>
        {% endfor %}
    </div>
</div>

<!-- Class Commanders and Classes Section -->
<div class="staff-section class-section">
    <h2>Classes and Commanders</h2>
    <div class="class-grid">
        {% for class in classes %}
        <div class="class-card">
            <h4>{{ class.name }}</h4>
            {% if class.class_commander %}
            <p><strong>Commander:</strong> {{ class.class_commander.get_full_name }}</p>
            {% else %}
            <p><strong>Commander:</strong> Not assigned</p>
            {% endif %}
            <p><strong>Students:</strong> {{ class.student_count }}</p>
        </div>
        {% empty %}
        <p>No Classes configured</p>
        {% endfor %}
    </div>
</div>

<!-- Recent Activities Section -->
<div class="staff-section">
    <h2>Recent Activities</h2>
    <div style="margin-top: 1rem;">
        <h3>Recent Student Registrations</h3>
        <ul>
            {% for student in recent_students %}
            <li>
                {{ student.user.get_full_name }} - 
                {% if student.class_group %}
                Class: {{ student.class_group.name }}
                {% else %}
                No class assigned
                {% endif %}
            </li>
            {% empty %}
            <li>No recent registrations</li>
            {% endfor %}
        </ul>
    </div>

    <div style="margin-top: 1rem;">
        <h3>Suspended Students</h3>
        <ul>
            {% for student in suspended_students %}
            <li>
                {{ student.user.get_full_name }} - 
                {% if student.class_group %}
                Class: {{ student.class_group.name }}
                {% endif %}
                (Suspended on: {{ student.suspended_at|date:"F j, Y" }})
            </li>
            {% empty %}
            <li>No suspended students</li>
            {% endfor %}
        </ul>
    </div>
</div>
{% endblock %}